---
doc_type: "pattern-logic"
status: "draft"
depends:
  contracts:
    - "usage-context"
    - "development-constraints"
  produces:
    - "security-requirements"
---

# セキュリティ

## 前提

<!-- PREMISE_BEGIN: usage-context -->

- **利用者**: 単一ユーザー専用システム
  - 個人の思考プロセスに完全最適化
  - マルチユーザー対応の複雑性を排除
  - 「ツッコミを入れる」個人的判断プロセスの前提

<!-- PREMISE_END: usage-context -->

<!-- PREMISE_BEGIN: development-constraints -->

- シンプルで理解しやすい構造、一人で管理可能な複雑度に制限する。

<!-- PREMISE_END: development-constraints -->

### セキュリティ環境特性

- **個人環境限定**: 作成者のみがアクセスする閉じた環境
- **外部サービス依存**: Cloudflare Access 等による外部アクセス制御を前提
- **プロトタイプ段階**: 高度なセキュリティ機能より基本機能実装を優先
- **法的要件**: 個人情報保護法・各種サービス利用規約の遵守が必要

## 論理

### 個人環境限定による攻撃対象面軽減

単一ユーザー専用システムで作成者個人環境のみでの利用であるため、一般的な Web アプリケーションで想定される外部攻撃者からの脅威は大幅に軽減される。むしろ、複雑なセキュリティ機能より基本的な対策に集中し、開発・保守コストを抑制すべきである。

### 外部サービス活用による責任分離

アクセス制御や HTTPS 暗号化等の高度なセキュリティ機能は、Cloudflare Access 等の専門外部サービスに委譲することで、アプリケーション側の複雑度を抑制できる。プロトタイプ段階では、自前実装より信頼性の高い外部サービス活用が適切である。

### プロトタイプ段階による段階的セキュリティ実装

現在はプロトタイプ段階であるため、高度なセキュリティ機能(データ暗号化・詳細アクセス制御等)より、基本的なセキュリティ対策(SQL インジェクション・XSS 対策)と法的要件遵守を優先すべきである。

### 外部 API 利用による標準セキュリティ要件

LLM API や MCP 統合等の外部 API 利用時は、各サービスの利用規約遵守と HTTPS 通信が必須である。また、個人の思考データを扱うため、プライバシー配慮設計も重要である。

## 結論

CogitoWeave のセキュリティ制約を以下のように決定する。なお、アクセス制御や HTTPS 暗号化についてはこのプロダクトではなく、Cloudflare Access などの外部サービスを利用することを前提とする。

<!-- GLOBAL_CONCLUSION_BEGIN: security-requirements -->

- 必須対応
  - 外部 API 接続時の HTTPS 通信(LLM API・MCP 統合)
  - SQL インジェクション対策・XSS 対策の基本実装
  - 個人情報保護法に基づくプライバシー配慮設計
  - LLM API 利用規約・各種サービス規約の遵守
  - 攻撃対象面の限定(作成者個人環境のみ)によるリスク軽減
- 任意対応
  - 作成者本人のみアクセス可能なアクセス制御
  - 全通信の HTTPS 暗号化
- 除外対応
  - 高度なユーザー認証機能(プロトタイプ段階)
  - データ暗号化(プロトタイプ段階)
  - 詳細なアクセス制御(プロトタイプ段階)

<!-- GLOBAL_CONCLUSION_END: security-requirements -->
