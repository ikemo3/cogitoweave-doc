---
doc_type: "pattern-logic"
status: "draft"
depends:
  contracts: []
  produces: []
---

# 概念関連作成API (Command)

## 前提

CogitoWeaveシステムでは概念関連が概念間の論理的な関連を管理するエンティティである。概念関連は起点概念と終点概念の2つの概念を関連付け、関係性ネットワークを構築する。

概念関連作成は概念関係性構築ワークフローで関係定義・意味付け機能の後に実行される。ユーザーが定義した概念間の関係を永続化する責務を持つ。

概念関連作成はCommandパターンに従うデータ変更操作として、概念関連エンティティをシステムに追加する。

## 論理

### API呼び出し方向

```text
UI → RelationshipService.createConceptRelation(C)
```

**役割名ベース**: RelationshipServiceが関係性管理の責務を担当

### 入力項目 (概念レベル)

- **起点概念ID**: 関係の出発点となる概念の識別子
- **終点概念ID**: 関係の到達点となる概念の識別子
- **関係ラベル**: ユーザーが定義した関係の名称・意味
- **関係強度**: 関係の強さを表す度合い（オプション）

### 出力項目 (概念レベル)

- **関連ID**: 作成された概念関連の一意識別子
- **作成結果**: 関連作成の成功・失敗状態
- **関連情報**: 作成された概念関連の基本情報

### エラー項目 (概念レベル)

- **概念存在エラー**: 指定された起点または終点概念が存在しない場合
- **自己参照エラー**: 起点と終点が同一概念の場合
- **重複エラー**: 同一の起点・終点・ラベルの組み合わせが既に存在する場合
- **システムエラー**: データ保存失敗等の内部エラー

### CQRS分類

**Command**: データ変更を伴う操作 - 新規概念関連エンティティの作成

## 結論

概念関連作成APIは新規概念関連エンティティの作成を担当するCommand操作として、起点・終点概念と関係ラベルを入力とし、作成された関連情報を返す。

エラーハンドリングでは概念の存在確認と関係の妥当性検証を行い、適切なエラー情報を提供する。このAPIは概念関係性構築ワークフローの完了機能として、知識ネットワーク構築を実現する役割を担う。
