---
doc_type: "pattern-logic"
status: "draft"
depends:
  contracts:
    - "domain-model"
    - "design-boundries"
    - "data-protection-requirements"
  produces:
    - "batch-specification"
---

# バッチ仕様

## 前提

<!-- PREMISE_BEGIN: domain-model -->

CogitoWeave のドメインモデルは薄いドメイン層アプローチを採用する。4 つのエンティティ（概念、文献メモ、関係性、文献）に対して基本的な CRUD 操作と最小限のビジネス制約のみを実装し、複雑なドメインロジックはアプリケーション層に委ねる。データベース制約による整合性管理を活用し、外部 API 処理は分離する。

<!-- PREMISE_END: domain-model -->

<!-- PREMISE_BEGIN: design-boundries -->

1. **思考支援に特化**: 万能ツールではなく、考えをまとめることだけに集中
2. **人間が主導**: LLM は叩き台提供のみ、考える楽しみは人間が味わう
3. **完全に個人的**: 他人の評価ではなく、自分の問題解決が価値基準
4. **自然な関係性**: 学術的分類ではなく、個人の思考パターンを重視

<!-- PREMISE_END: design-boundries -->

### データ保護要件

<!-- PREMISE_BEGIN: data-protection-requirements -->

- **自動バックアップ**: 日次自動バックアップによる合理的なデータ保護
- **迅速復旧**: 障害発生時の当日復旧を目標とした手順整備
- **部分ロス許容**: 完全なゼロリスクは求めず、実用的保護レベルで運用

<!-- PREMISE_END: data-protection-requirements -->

個人開発における制約から、複雑なバッチ処理は保守負荷を増大させる。データベース制約による整合性管理により、データクリーンアップ等の処理は不要となる。

## 論理

第一に、CogitoWeave の設計境界により自動化による価値判断は除外される。「他人の評価ではなく、自分の問題解決が価値基準」の原則から、関係性の自動発見や推奨機能はシステムの本質に反する。

第二に、データベース制約による整合性管理により、従来必要とされるデータクリーンアップ処理は不要である。概念削除時のカスケード処理や孤立データの発生防止は、RDBMS の参照制約で自動的に保証される。

第三に、システム障害からの保護が唯一の必要なバッチ処理である。ハードウェア故障等の不可避な障害に対して、日次バックアップによる実用的なデータ保護を実現する必要がある。

第四に、個人開発の制約から、バッチ処理は最小限に留めるべきである。複数のバッチ処理を管理する複雑性よりも、単一の明確な責務を持つシンプルな設計が適している。

## 結論

<!-- GLOBAL_CONCLUSION_BEGIN: batch-specification -->

CogitoWeave のバッチ仕様は日次データバックアップのみを実装する。全データの完全バックアップを日次実行し、システム障害時の迅速復旧を支援する。自動分析・推奨機能、データクリーンアップ、統計処理等は設計方針により除外する。

<!-- GLOBAL_CONCLUSION_END: batch-specification -->
