---
doc_type: "pattern-logic"
status: "draft"
depends:
  contracts: []
  produces:
    - "backend-architecture-style"
---

# バックエンドアーキテクチャスタイル

## 前提

### 他設計書との接続点

<!-- REFERENCE_BEGIN: core-knowledge-boundary -->

- コア知識管理境界は概念管理、文献メモ管理、関係性管理、質問探索を統合して担当する。
  - 各機能の役割を明確に分け、統合的に管理することで保守負荷を軽減するため。

<!-- REFERENCE_END: core-knowledge-boundary -->

<!-- REFERENCE_BEGIN: domain-model -->

CogitoWeave のドメインモデルは薄いドメイン層アプローチを採用する。4 つのエンティティ（概念、文献メモ、関係性、文献）に対して基本的な CRUD 操作と最小限のビジネス制約のみを実装し、複雑なドメインロジックはアプリケーション層に委ねる。データベース制約による整合性管理を活用し、外部 API 処理は分離する。

<!-- REFERENCE_END: domain-model -->

<!-- REFERENCE_BEGIN: batch-specification -->

CogitoWeave のバッチ仕様は日次データバックアップのみを実装する。全データの完全バックアップを日次実行し、システム障害時の迅速復旧を支援する。自動分析・推奨機能、データクリーンアップ、統計処理等は設計方針により除外する。

<!-- REFERENCE_END: batch-specification -->

### 確立された事実

<!-- REFERENCE_BEGIN: development-constraints -->

- シンプルで理解しやすい構造、一人で管理可能な複雑度に制限する。

<!-- REFERENCE_END: development-constraints -->

<!-- REFERENCE_BEGIN: performance-requirements -->

- 必須対応
  - 概念ページ読み込み: 2 秒以内(既存ツールレベル)
  - 検索結果表示: 1 秒以内(現代の検索体験期待)
  - LLM API 呼び出し: 10 秒以内(生成 AI 市場期待)
  - データベース応答: ミリ秒オーダー(現代ソフトウェア基本期待)
- 任意対応
  - 既存ツールを上回るパフォーマンス最適化
- 除外対応
  - 複数ユーザー同時アクセス: 個人ツール市場では期待されない
  - 大規模データ処理: 個人用途範囲を超える性能は不要
  - 企業向け機能: 個人ツール市場では要求されない

<!-- REFERENCE_END: performance-requirements -->

### 判断基準

アーキテクチャスタイル選択において、保守性・理解しやすさを最重視し、機能境界の論理的分離と実行時統合のバランス、開発・運用の複雑度制限を判断基準とする。

### スコープ境界

バックエンドの実行時アーキテクチャスタイルの決定のみを扱い、具体的な技術選択・実装詳細・デプロイメント構成は扱わない。

## 論理

第一に、CogitoWeave は個人用途の思考支援システムであり、大規模システムレベルの分散システム要件(高可用性、水平スケーリング、チーム境界に基づく独立デプロイ)を満たす必要がない。一人開発における最大の制約は保守性であり、システム全体を理解・管理できる複雑度に留める必要がある。

第二に、機能境界分析により論理的には 3 つの境界(コア知識管理、LLM 統合、コンテンツ取得)に分離されているが、ドメイン複雑度は薄いドメイン層で対応可能であり、バッチ特性も単純な日次バックアップのみである。これらの特性は、各境界を独立したサービスとして分離する技術的必然性が低いことを示している。

第三に、個人ツールとしての運用特性と薄いドメイン層の特性を考慮すると、レイヤードアーキテクチャが最適である。階層的な責務分離による明確な構造と、機能境界に基づく水平分割により、一人開発における理解しやすさと保守性を確保できる。単一のデプロイ単位として運用しながら、将来的な拡張にも対応可能な構造である。

## 結論

<!-- GLOBAL_CONCLUSION_BEGIN: backend-architecture-style -->

CogitoWeave のバックエンドアーキテクチャスタイルとして**レイヤードアーキテクチャ**を採用する。階層的な責務分離と機能境界に基づく水平分割により、一人開発における保守性と理解しやすさを確保する。

<!-- GLOBAL_CONCLUSION_END: backend-architecture-style -->
