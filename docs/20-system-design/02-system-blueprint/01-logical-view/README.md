---
doc_type: "pattern-elaboration"
status: "draft"
depends:
  contracts: []
  produces:
    - "logical-view"
---

# Logical View

## 前提

- システムの論理構造・関係・振る舞いを定義する。
- 情報の成長段階を論理的に管理する。

## 論理

- **主語（誰の視点）**: ユーザー / 設計者
- **時間（いつの話）**: 設計時
- **関心（何を示す）**: 機能と責務の分割（何を）
- **代表アウトプット**: ドメイン/機能分割図、コンポーネント境界、API 契約（抽象）

## 分割

### 定義対象

<!-- FOUNDATION_BEGIN: logical-view -->

- 主要抽象化設計
- 機能境界と責務
- UI 要素
- データモデル
- システムクラス・オブジェクトモデル設計
- ワークフロー
- API 契約（機能仕様、何をするか）
- 品質属性とトレードオフ

<!-- FOUNDATION_END: logical-view -->

この順番で定義する理由は次の通りです。

まず**主要抽象化設計**でシステムの根本概念を定義します。これがすべての設計判断の基盤となり、ドメインの本質的な概念を明確化します。

次に**機能境界と責務**で Bounded Context を定義します。マイクロサービスアーキテクチャを採用する場合も、モノリスを採用する場合も、適切な責務境界の定義が設計の成否を決めるため、論理レベルでの境界設定が最重要です。

次に**UI 要素**を定義します。これは主に入力インターフェースを中心とし、Command 系の操作を明確化します。入力から設計を始めることで、ユーザーの意図を正確に捉えたデータ設計が可能になります。

次に**データモデル**を定義します。これは DOA(Data Oriented Architecture)の考え方に基づき、データの一貫性と整合性を重視します。ER 図で Entity 間の関係を定義し、データ構造の論理的な基盤を確立します。

次に**システムクラス・オブジェクトモデル設計**で、データを操作する処理クラスとオブジェクト間の関係性・協調パターンを統合的に定義します。DOA の考え方により、データ構造を先に確定してから処理とオブジェクト関係を設計することで、データの整合性を保ちやすくなります。

次に**ワークフロー**で、システムクラス・オブジェクト間の協調手順を定義します。これにより「何をどの順序で実行するか」が明確になります。

次に**API 契約**で、ワークフローを実現するための具体的なインターフェース仕様を定義します。ワークフローが確定してから必要な API を導出することで、過不足のない設計が可能になります。

最後に**品質属性とトレードオフ**で非機能要件を定義します。機能的な設計が固まった後で、性能・可用性・セキュリティ等の品質要求を検討することで、実現可能性のある品質目標を設定できます。

この 8 つの要素は段階的詳細化を形成し、互いに矛盾が生じてはいけません。これは Kruchten 4+1 モデルの網羅性を保ちつつ、DOA 的なアプローチで論理的な設計順序を実現しています。

### 機能境界と責務

システムの機能を論理的に分割し、各コンポーネントの責務を明確に定義する。

- **ドメイン分割**: ビジネス領域に基づく機能の境界設定
- **コンポーネント責務**: 各モジュールが担当する具体的な役割と範囲
- **依存関係の方向**: コンポーネント間の依存性とその制約
- **インターフェース定義**: コンポーネント間の協調点と契約

### UI 要素

シナリオから抽出した UI 要素を詳細化する。

### データモデル

- Mermaid ER 図で**エンティティと関係のみ**を記述（属性や型は書かない）。
- 関係ラベルは必要に応じて日本語で付ける。

### ワークフロー

- 個別ワークフローは**直列のみ**の Mermaid flowchart（並列・再試行・条件分岐なし）。
- 手順前後に**目的／トリガ／終了条件／境界越え**を明記。
- 境界越え索引用に**全 WF まとめ図**（Mermaid subgraph）を別途作成可。

### API 契約

- 呼び出し方向は**役割名ベース**で統一＋ CQRS の C/Q を付与。
- 入力／出力／エラーは概念項目のみ（型や実装詳細は書かない）。

### 品質属性とトレードオフ

システムの非機能要件を論理的に分析し、設計上の判断を記録する。

- **非機能要件ごと**に並べる（性能、可用性、一貫性、信頼性、変更容易性、拡張性、可観測性、セキュリティ、UX 適合性、コスト意識、相互運用性など必要分）。
- 各特性は「期待する性質／優先度／トレードオフ相手／論理的影響／判断／備考」で記述（数値や実装詳細は書かない）。
