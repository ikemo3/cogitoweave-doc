<!-- markdownlint-disable MD024 -->

# Logical 制約検出における技術配置

## Logical View 制約の見直し

<!-- REFERENCE_BEGIN: logical-constraint-verification-mapping -->

### Backend Container

#### Python + FastAPI

- API 契約:
  - エンティティ操作 API: 概念 API、文献メモ API、関係性 API、文献 API
  - 検索・発見 API: 概念検索 API、質問から概念候補提示 API
  - 協働・処理 API: LLM 要約生成 API、記事取得 API、バックアップ API
- API 技術方針:
  - REST API 採用
- バックエンドアーキテクチャスタイル:
  - レイヤードアーキテクチャ採用
  - 階層的な責務分離
  - 機能境界に基づく水平分割
  - 一人開発における保守性と理解しやすさ
- バッチ仕様:
  - 日次データバックアップのみを実装
  - 全データの完全バックアップを日次実行
  - 自動分析・推奨機能、データクリーンアップ、統計処理等は設計方針により除外
- ドメインモデル:
  - 薄いドメイン層アプローチを採用
  - 4 つのエンティティに対して基本的な CRUD 操作と最小限のビジネス制約のみを実装
  - 複雑なドメインロジックはアプリケーション層に委ねる
- 機能境界と責務:
  - コア知識管理境界: 概念管理、文献メモ管理、関係性管理、質問探索を統合して担当
    - データベース操作とトランザクション境界を重点的に検証
  - LLM 統合境界: LLM API による要約生成、概念候補提示、協働プロセス制御を担当
    - 外部 API の契約テストと異常ケース対応を強化
  - コンテンツ取得境界: 外部記事取得、内容解析、品質チェックを担当
    - 構造変更への適応性を継続的に検証
- 主要抽象化設計:
  - 抽象化の相互作用: 外部文献 → 概念フィルター → 文献メモの情報個人化プロセス

#### FastAPI 標準 Pydantic

- API 契約:
  - エンティティ操作 API: 概念 API、文献メモ API、関係性 API、文献 API

#### SQLAlchemy + Alembic

- API 契約:
  - エンティティ操作 API: 概念 API、文献メモ API、関係性 API、文献 API
- ドメインモデル:
  - 4 つのエンティティに対して基本的な CRUD 操作と最小限のビジネス制約のみを実装
  - データベース制約による整合性管理を活用
- データベース方針:
  - リレーショナル構造によるデータ整合性管理
- データモデル:
  - 概念エンティティ: 思考の最小単位として知識体系の中心に位置し、他の概念との関係性によって意味を形成し、外部情報を個人の理解に変換する観点として機能
  - 文献メモエンティティ: ツェッテルカステン方式による概念ベースの知識蓄積として、特定の概念の観点で外部文献を要約・解釈し、LLM 協働により効率的に作成され個人の理解で修正される
  - 関係性エンティティ: 概念間の無向グラフ構造による知識ネットワーク形成として、個人的な関係語彙による柔軟な関係定義と空間配置による直感的な関係性発見を支援
  - 文献エンティティ: 外部文献の書誌情報管理として複数の概念観点から文献メモが生成される元情報
- 機能境界と責務:
  - コア知識管理境界: 概念管理、文献メモ管理、関係性管理、質問探索を統合して担当
- 主要抽象化設計:
  - 概念: 思考の最小単位として知識体系の中心に位置し、外部情報を個人の理解に変換するフィルターとして機能
  - 文献メモ: 概念に綐づく具体的知識内容を表現し、外部文献を個人の観点で解釈した結果として、LLM 協働により効率的に作成され個人の理解で修正される
  - 関係性: 概念間の関連性を表現し知識ネットワークを形成し、個人的な関係語彙による柔軟な関係定義と空間配置による直感的な関係性発見を支援

#### httpx

- API 契約:
  - 協働・処理 API: LLM 要約生成 API、記事取得 API、バックアップ API
- ドメインモデル:
  - 外部 API 処理は分離
- 機能境界と責務:
  - LLM 統合境界: LLM API による要約生成、概念候補提示、協働プロセス制御を担当
  - コンテンツ取得境界: 外部記事取得、内容解析、品質チェックを担当
- 主要抽象化設計:
  - 文献メモ: LLM 協働により効率的に作成され個人の理解で修正される

#### uvicorn

- API 技術方針:
  - システム初回起動パフォーマンスバジェット

#### loguru

- バッチ仕様:
  - システム障害時の迅速復旧を支援
  - バックアップ処理の成功・失敗をログとして出力し、迅速な障害対応を支援する
- 機能境界と責務:
  - コア知識管理境界: データ整合性と応答時間を監視
  - LLM 統合境界: 外部 API 依存性を監視
  - コンテンツ取得境界: 取得成功率と構造変更を追跡

### Frontend Container

#### Solid + TanStack Router

- API 技術方針:
  - システム初回起動パフォーマンスバジェット
  - 概念ページ読み込みパフォーマンスバジェット
- フロントエンドレンダリングスタイル:
  - CSR(Client-Side Rendering)採用
  - 3 画面間の状態共有効率
  - 軽量なコンポーネント指向の特性
  - 一人での開発における保守性と理解しやすさ
- UI コンポーネント責務:
  - 階層的な粒度設計による軽量なコンポーネント指向アーキテクチャ
  - コンポーネント内部状態とページレベル状態とアプリケーション全体状態の 3 層分離
  - コンテナコンポーネントパターンと単方向データフロー
- UI 技術方針:
  - Web 技術による柔軟な実装アプローチを採用
  - レンダリング方式として CSR を選択
  - 軽量コンポーネント指向を基本とする
  - 保守性と理解しやすさの優先
  - 一人での管理可能な複雑度
- 画面構成設計:
  - メイン画面は概念管理、文献メモ管理、関係性管理を 1 画面に統合
  - 質問探索画面は質問から概念発見とメモ参照を独立画面で提供
- 主要抽象化設計:
  - 抽象化の相互作用: 外部文献 → 概念フィルター → 文献メモの情報個人化プロセス

#### TanStack Router

- UI 技術方針:
  - アプリケーション構造として SPA を選択
- 画面構成設計:
  - シンプルなタブ切り替えによる 3 画面間の移動

#### Tailwind CSS + CSS Modules

- UI コンポーネント責務:
  - コンポーネント共通化とレスポンシブ設計による適応的 UI
- UI 技術方針:
  - Mac 環境での情報整理機能と iPhone 環境での情報参照機能の最適化

#### D3

- 画面構成設計:
  - 空間配置画面は概念の空間配置と関係性構築を専用画面で提供
- 主要抽象化設計:
  - 関係性: 概念間の関連性を表現し知識ネットワークを形成し、個人的な関係語彙による柔軟な関係定義と空間配置による直感的な関係性発見を支援

### Database Container

#### SQLite

- データベース方針:
  - RDBMS を採用
  - リレーショナル構造によるデータ整合性管理
  - 成熟技術による保守性確保
  - データ規模への十分な対応能力
- ドメインモデル:
  - データベース制約による整合性管理を活用
- データモデル:
  - 概念エンティティ: 思考の最小単位として知識体系の中心に位置し、他の概念との関係性によって意味を形成し、外部情報を個人の理解に変換する観点として機能
  - 文献メモエンティティ: ツェッテルカステン方式による概念ベースの知識蓄積として、特定の概念の観点で外部文献を要約・解釈し、LLM 協働により効率的に作成され個人の理解で修正される
  - 関係性エンティティ: 概念間の無向グラフ構造による知識ネットワーク形成として、個人的な関係語彙による柔軟な関係定義と空間配置による直感的な関係性発見を支援
  - 文献エンティティ: 外部文献の書誌情報管理として複数の概念観点から文献メモが生成される元情報
- バッチ仕様:
  - 日次データバックアップのみを実装
  - 全データの完全バックアップを日次実行
- 主要抽象化設計:
  - 概念: 思考の最小単位として知識体系の中心に位置し、外部情報を個人の理解に変換するフィルターとして機能
  - 文献メモ: 概念に綐づく具体的知識内容を表現し、外部文献を個人の観点で解釈した結果として、LLM 協働により効率的に作成され個人の理解で修正される
  - 関係性: 概念間の関連性を表現し知識ネットワークを形成し、個人的な関係語彙による柔軟な関係定義と空間配置による直感的な関係性発見を支援

<!-- REFERENCE_END: logical-constraint-verification-mapping -->
